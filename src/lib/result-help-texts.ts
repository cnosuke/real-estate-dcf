/**
 * DCF分析結果の各指標についての詳細説明
 * OUTPUT_GUIDE.mdの内容を初心者向けに翻訳
 */
export const RESULT_HELP_TEXTS = {
  // 基本指標
  npvAsset: {
    title: 'NPV（ネット・プレゼント・バリュー）- 資産',
    shortDescription: '借入を考慮しない物件自体の投資妙味',
    description:
      '将来のキャッシュフローを現在価値に割り引いた合計。物件そのものの投資価値を表します。',
    interpretation: {
      positive: '要求利回り水準を上回る投資妙味がある',
      negative: '要求利回り水準を下回る（他の投資の方が良い）',
      zero: '要求利回り水準と同等（投資判断は他の要因で決める）',
    },
    detail: `NPVは「この投資がどれだけお得か」を表す最も重要な指標です。

【計算の仕組み】
将来得られるお金を、今の価値に換算して合計したものです。

【判断基準】
• NPV > 0：投資価値あり（要求利回りを上回る）
• NPV = 0：要求利回りと同等
• NPV < 0：投資価値なし（要求利回りを下回る）

【例】
• NPV = 500万円 → この投資により500万円分の価値を得られる
• NPV = -200万円 → 期待する利回りより200万円分価値が低い

【注意点】
割引率の設定によって大きく変わるため、適切な割引率設定が重要です。`,
    tips: 'NPVがプラスでも、金額の大小だけでなく投資額に対する比率も考慮しましょう。',
  },

  npvEquity: {
    title: 'NPV - エクイティ（自己資本）',
    shortDescription: '借入活用時の自己資金に対する投資妙味',
    description:
      '借入を活用した場合の自己資本部分の投資価値。レバレッジ効果を反映。',
    interpretation: {
      positive: '自己資本の期待収益を上回る',
      negative: '自己資本の期待収益を下回る',
      zero: '自己資本の期待収益と同等',
    },
    detail: `借入を活用することで、自己資金に対するリターンがどう変わるかを示します。

【レバレッジ効果】
• 物件利回り > 借入金利 → レバレッジ効果でエクイティNPVが向上
• 物件利回り < 借入金利 → レバレッジが負の効果（エクイティNPV悪化）

【例】
• 自己資金1,000万円でエクイティNPV = 300万円
• → 自己資金に対して30%の価値向上

【アセットNPVとの比較】
• エクイティNPV > アセットNPV：レバレッジ効果あり
• エクイティNPV < アセットNPV：レバレッジ効果なし（金利が高い）

【リスク】
レバレッジにより変動幅も大きくなるため、リスクも増大します。`,
    tips: 'エクイティNPVが高くても、リスクの増大を考慮して総合的に判断しましょう。',
  },

  irrAsset: {
    title: 'IRR（内部収益率）- 資産',
    shortDescription: '借入を考慮しない物件自体の年平均利回り',
    description:
      '物件自体が生み出す年平均の収益率。借入を使わない場合の投資利回り。',
    interpretation: {
      high: '資産割引率を上回れば投資価値あり',
      low: '資産割引率を下回れば投資価値なし',
    },
    detail: `物件そのものが「年何%の利回りを生むか」を表す指標です。

【わかりやすい例】
IRR 7% = 毎年7%ずつお金が増える投資と同等の価値

【判断基準】
• IRR > 資産割引率：投資価値あり
• IRR = 資産割引率：投資価値は中立
• IRR < 資産割引率：投資価値なし

【他の投資との比較】
• 預金金利：0.001%
• 国債：0.5-1%
• 株式（長期平均）：5-7%
• 不動産（目安）：4-8%

【期末価格への依存度】
IRRが高くても、売却価格に大きく依存している場合は注意が必要です。

【実用性】
銀行の定期預金や他の投資商品と比較しやすい指標です。`,
    tips: 'IRRは分かりやすい指標ですが、期末売却価格の影響を大きく受けることに注意しましょう。',
  },

  irrEquity: {
    title: 'IRR - エクイティ（自己資本）',
    shortDescription: '借入活用時の自己資金に対する年平均利回り',
    description:
      '借入を活用した場合の自己資本部分の年平均収益率。レバレッジ効果を反映。',
    interpretation: {
      high: 'エクイティ割引率を上回れば投資価値あり',
      low: 'エクイティ割引率を下回れば投資価値なし',
    },
    detail: `自己資金に対して「年何%の利回りが得られるか」を表します。

【レバレッジ効果の例】
• 物件利回り6%、借入金利2%の場合
• レバレッジによりエクイティIRRは6%を上回る可能性

【投資タイプ別の目安】
• Core（安定重視）：9-12%
• Value-add（改善前提）：13-16%
• Opportunistic（高リスク）：18%以上

【注意点】
• 高IRRでも途中のキャッシュフローが薄い場合は要注意
• 期末売却価格への依存度が高い場合は慎重に判断

【比較対象】
• 株式投資の期待リターン
• 他の不動産投資機会
• REITの配当利回り + 値上がり期待

【リスクとリターン】
高いIRRには相応のリスクが伴うことを理解しましょう。`,
    tips: 'IRRの数値だけでなく、そのIRRを実現するための前提条件も確認しましょう。',
  },

  salePriceNet: {
    title: '売却純額',
    shortDescription: '売却コストを差し引いた手取り売却金額',
    description:
      '保有期間終了時の売却価格から、仲介手数料等のコストを差し引いた金額。',
    interpretation: {
      high: '期末回収額が大きく、投資収益に大きく寄与',
      low: '期末回収額が小さく、運営収益への依存度が高い',
    },
    detail: `投資期間終了時に実際に手元に入る売却代金です。

【価格パス方式による算出】
• 初期価格 × (1 + インフレ率 - 価値逓減率)^保有年数
• 売却コスト（仲介手数料等）を差し引いた純額

【売却コストの内訳】
• 仲介手数料：3% + 6万円 + 消費税
• 譲渡所得税：利益に対して課税
• その他費用：印紙、登記等

【税金の影響】
• 短期譲渡（5年以下）：約39%
• 長期譲渡（5年超）：約20%
• 利益が出ない場合：課税なし

【投資戦略への影響】
• 売却純額が大きい → キャピタルゲイン重視
• 売却純額が小さい → インカムゲイン重視

【リスク】
売却時の市場環境により大きく変動する可能性があります。`,
    tips: '売却純額は予測値です。実際の売却時には市場環境の変化を考慮する必要があります。',
  },

  remainingDebtAtExit: {
    title: '売却時残債',
    shortDescription: '売却時点で残っている借入金残高',
    description:
      '保有期間終了時点での借入金残高。売却代金から返済する必要がある金額。',
    interpretation: {
      low: '残債が少なく、売却時の自己資本回収が容易',
      high: '残債が多く、売却純額からの控除インパクトが大きい',
    },
    detail: `売却時に一括返済する必要がある借入金の残高です。

【残債の決まり方】
• 返済期間 > 保有期間：残債あり
• 返済期間 = 保有期間：残債なし（完済）
• 返済期間 < 保有期間：途中で完済済み

【売却への影響】
• 売却純額 > 残債：問題なし
• 売却純額 < 残債：売却不可（追加資金が必要）

【残債比率の目安】
• 残債/売却純額 ≤ 50%：良好
• 50-70%：注意が必要
• > 70%：自己資本回収が困難

【対策】
• 繰上返済による残債削減
• 長期保有による自然減少
• 借り換えによる条件改善

【リスク管理】
売却時の市場価格下落に備え、残債比率は低めに設定することが安全です。`,
    tips: '残債が多い場合は、売却以外の出口戦略（長期保有継続等）も検討しましょう。',
  },

  implicitCap: {
    title: '暗黙のキャップレート',
    shortDescription: '売却価格の妥当性をチェックする指標',
    description:
      '翌年の予想NOIを売却価格で割った利回り。市場相場との整合性確認に使用。',
    interpretation: {
      reasonable: '市場の一般的なキャップレートの範囲内',
      low: '売却価格が高め、または翌年NOIが低め',
      high: '売却価格が低め、または翌年NOIが高め',
    },
    detail: `売却時価格が市場相場と整合しているかを確認する指標です。

【計算式】
暗黙Cap = 翌年NOI ÷ 売却価格（コスト控除前）

【市場キャップレートとの比較】
• 東京都心住宅：3-5%
• 東京郊外住宅：4-6%
• 地方都市住宅：6-10%
• 商業物件：5-8%

【判断基準】
• 市場Cap ± 100bps以内：妥当
• 市場Capより150bps以上低い：売却価格が楽観的
• 市場Capより150bps以上高い：売却価格が悲観的

【調整方法】
• 高すぎる場合：価格逓減率を上げる、インフレ率を下げる
• 低すぎる場合：価格逓減率を下げる、インフレ率を上げる

【重要性】
この指標が市場から大きく乖離している場合、投資前提を見直す必要があります。`,
    tips: '暗黙Capが市場相場から大きく外れている場合は、前提条件を見直しましょう。',
  },

  // キャッシュフロー関連
  cashFlowSummary: {
    title: 'キャッシュフロー分析',
    description: '年次の収入と支出の流れ、および投資期間を通じた資金の動き',
    detail: `キャッシュフローは投資の「血液」です。毎年どれだけのお金が入り、どれだけ出ていくかを表します。

【アセットキャッシュフロー】
借入を考慮しない物件そのもののお金の流れ
• 収入：家賃収入
• 支出：運営費、固定資産税
• 最終年：上記 + 売却純額

【エクイティキャッシュフロー】
自己資金に対する実際のお金の流れ
• アセットキャッシュフロー - 借入返済
• 最終年：上記 - 残債返済

【健全性の判断】
• プラス継続：健全
• 初期マイナス、後半プラス：一般的
• 連続マイナス：要注意

【改善方法】
• 家賃アップ：リフォーム、付加価値向上
• コスト削減：管理費見直し、税務最適化
• 融資条件改善：借り換え、返済期間延長`,
    tips: 'キャッシュフローは「絵に描いた餅」ではなく、実際に手元に入るお金です。現実的に設定しましょう。',
  },

  // 投資判断指標
  investmentDecision: {
    title: '総合投資判断',
    description: '各指標を総合した投資の魅力度評価',
    detail: `複数の指標を組み合わせて、総合的な投資判断を行います。

【判断フロー】
1. NPV（Asset/Equity）が0以上か？
2. IRR（Asset/Equity）が要求利回りを上回るか？
3. キャッシュフローに無理がないか？
4. 残債比率が過大でないか？
5. 暗黙Capが市場相場から大きく外れていないか？

【良好な投資の目安】
• 全てのNPVがプラス
• 全てのIRRが要求利回りを上回る
• エクイティキャッシュフローが安定してプラス
• 残債比率が適正範囲内
• 暗黙Capが市場相場と整合

【注意が必要なケース】
• IRRは高いがNPVが低い（期末頼み）
• エクイティキャッシュフローが不安定
• 暗黙Capが市場から大きく乖離

【最終判断のポイント】
数値だけでなく、前提条件の実現可能性も重要です。`,
    tips: '単一指標だけでなく、複数指標を総合的に判断することが重要です。',
  },
} as const

// 指標グループ別の説明
const INDICATOR_GROUPS = {
  profitability: {
    title: '収益性指標',
    description: '投資がどれだけ儲かるかを表す指標',
    indicators: ['npvAsset', 'npvEquity', 'irrAsset', 'irrEquity'],
    explanation:
      'これらの指標は「この投資はやる価値があるか？」を判断するための最重要指標です。',
  },

  cashFlow: {
    title: 'キャッシュフロー指標',
    description: '実際のお金の出入りを表す指標',
    indicators: ['cashFlowSummary'],
    explanation: '投資期間中の実際の資金繰りを確認する指標です。',
  },

  exit: {
    title: '出口戦略指標',
    description: '売却時の条件を表す指標',
    indicators: ['salePriceNet', 'remainingDebtAtExit', 'implicitCap'],
    explanation: '投資の「出口」である売却時の条件を確認する指標です。',
  },

  risk: {
    title: 'リスク指標',
    description: '投資のリスクレベルを表す指標',
    indicators: ['implicitCap', 'remainingDebtAtExit'],
    explanation: '投資に伴うリスクの程度を確認する指標です。',
  },
} as const

// よくある質問と回答
export const RESULT_FAQ = [
  {
    question: '利益が見込めるかどうか、どこを見れば分かりますか？',
    answer:
      '「投資利益の見込み」セクションの自己資金利益（NPV）を確認してください。プラスなら利益が見込める投資です。また、総投資収益率が基準利回りを上回っていれば、期待する収益を満たす投資と言えます。',
  },
  {
    question: '毎月の支払いが赤字になりそうですが大丈夫ですか？',
    answer:
      '初期の数年間は家賃収入よりもローン返済の方が多く、毎月赤字になることは珍しくありません。重要なのは最終的に累積でプラスになるかどうかです。キャッシュフロー分析で年次推移を確認し、資金計画を立てましょう。',
  },
  {
    question: 'この物件は買いですか？やめた方がいいですか？',
    answer:
      '総合評価が「優良」「良好」なら投資を検討する価値があります。「要検討」の場合は条件交渉や運営方法の改善を、「要注意」の場合は購入価格の大幅な引き下げを検討するか、他の物件を探すことをお勧めします。',
  },
  {
    question: '売却時に借金が残っていても売れますか？',
    answer:
      '売却純額が残債を上回っていれば問題ありません。詳細分析の「残債比率」が50%以下なら良好、70%を超える場合は売却時に追加資金が必要になる可能性があります。長期保有により残債を減らすか、繰上返済も検討してください。',
  },
  {
    question: '計算結果は本当に信頼できるのでしょうか？',
    answer:
      'この計算は入力した前提条件に基づく予測値です。家賃相場、空室率、修繕費、インフレ率など、実際と異なる可能性があります。複数のシナリオ（悲観・標準・楽観）で計算し、リスクも含めて総合的に判断することが重要です。',
  },
  {
    question: '他の物件と比較するときのポイントは？',
    answer:
      '同じ前提条件で複数の物件を比較しましょう。NPVが高い物件、IRRが高い物件、キャッシュフローが安定している物件を優先的に検討してください。ただし、立地や建物の状態など、数値に表れない要素も必ず現地確認で判断しましょう。',
  },
  {
    question: '税金は考慮されていますか？',
    answer:
      '固定資産税は考慮されていますが、所得税・住民税は含まれていません。実際の手取り収益は税金分だけ少なくなります。また、売却時の譲渡所得税（短期39%、長期20%）も別途発生する可能性があります。税理士にご相談いただくことをお勧めします。',
  },
] as const

// ヘルプテキストのキー一覧を型として定義
type ResultHelpTextKey = keyof typeof RESULT_HELP_TEXTS
type IndicatorGroupKey = keyof typeof INDICATOR_GROUPS

// ヘルプテキストの取得ヘルパー関数
export function getResultHelpText(key: ResultHelpTextKey) {
  const helpInfo = RESULT_HELP_TEXTS[key]
  if (!helpInfo) {
    return null
  }

  return {
    title: helpInfo.title,
    content: `${helpInfo.description}\n\n${helpInfo.detail}\n\n💡 ${helpInfo.tips}`,
  }
}

function _getIndicatorGroup(key: IndicatorGroupKey) {
  return INDICATOR_GROUPS[key]
}
